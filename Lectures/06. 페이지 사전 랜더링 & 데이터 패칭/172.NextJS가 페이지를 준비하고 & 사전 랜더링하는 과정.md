# 172. NextJS가 페이지를 준비하고&사전 렌더링하는 방식

## 📌 Next.js는 페이지와 필요할 법한 모든 데이터가 있는 HTML 콘텐츠를 사전에 렌더링

> 페이지를 다시 클라이언트로 전송된 뒤에만 데이터를 로딩하는 대신에!

- 사전에 HTML 페이지를 완성해 놓고 완전히 채워진 HTML 파일을 클라이언트, 즉 페이지의 방문자에게 전송하는 것
- **SEO의 관점**에서 아주 훌륭함
- Next.js는 단순히 사전 렌더링된 페이지를 재전송하는 데 그치지 않고 포함된 JavaScript 코드를 모두 재전송함
  - 이런 재전송을 해당 페이지에 대해 **hydrate**한다고 함
- 재전송된 JavaScript 코드는 나중에 사전 렌더링된 페이지를 대체하고 이에 React가 알맞은 작업을 수행
- 이때 처음에 재전송한 사전 렌더링된 페이지에는 주요 콘텐츠가 모두 포함되어 있는 상태이기 때문에 이에 검색 엔진 크롤러도 전체 페이지에 이미 포함된 모든 콘텐츠를 살펴보게 됨
- 이때 상호작용 페이지가 아니어도 크롤러는 콘텐츠만 확인하니 문제가 되지 않음

→ **_이게 바로 사전 렌더링의 개념_**

- 더 정확히 말하면 Next.js는 페이지를 사전에 준비하는데 이때 모든 HTML 콘텐츠를 사전에 구축하고 필요할 모든 데이터를 사전에 로딩하는 방식을 따름
- 여기서 하나 짚고 넘어갈 점은 사전 렌더링은 오직 최초 로딩할 때만 영향을 미친다는 것
  - 페이지를 방문하면 로딩되는 첫 번째 페이지가 사전 렌더링 된 것
- Next.js와 React로 구축된 페이지에서는 **페이지의 hydrate, 즉 첫 번째 렌더링이 끝나고 나면 다시 표준 싱글 페이지 애플리케이션으로 돌아감**.
  그때부터는 **React가 프론트엔드에서 모든 처리를 수행**
- 그 후에 페이지가 바뀔 때, 즉 같은 웹사이트의 다른 페이지로 넘어갈 때는 해당 페이지가 사전 렌더링되지 않고 React를 통해 클라이언트 사이드에서 생성됨
- **사전 렌더링되는 건 최초 접속하는 첫 번째 페이지뿐**!
  - 따라서 React가 준비를 마칠 때까지 빈 페이지를 보는 대신에 모든 초기 콘텐츠가 포함된 사전 렌더링된 페이지가 표시되는 것

## 💡 이를 위해 Next.js에는 두 가지 사전 렌더링 양식이 있음

첫 번째 양식이자 권장 양식은 `정적 생성`

두 번째 양식은 `서버 사이드 렌더링(SSR)`이고 대체 가능

### 📌 SSR과 정적 생성의 가장 큰 차이

- 정적 생성은 **빌드되는 동안 모든 페이지가 사전 생성**된다는 것. 따라서 프로덕션용 애플리케이션을 구축한다면 **배포 전에 모든 페이지가 준비됨**
- 서버 사이드 렌더링의 경우에는 **배포 후 요청이 서버까지 오는 바로 그때 모든 페이지가 생성**됨
