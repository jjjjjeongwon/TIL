# 💡 이번엔 페이지를 찾을 수 없는 상황을 다뤄보자! (존재하지 않는 페이지를 요청하는 경우)

### 먼저 /p4로 페이지를 이동하면 404 에러 페이지가 뜸

우리가 다루는 ID는 p1, p2, p3밖에 없으므로 **ID 값이 p4인 상품이 없으니까** p4에 대한 페이지를 찾을 수 없는 것

- 찾을 수 없다는 에러 메시지가 뜨는 이유는 `getStaticPaths`에서 dummy-backend.js 파일로부터 생성해야 하는 페이지에 대한 ID나 라우트, 매개변수의 배열을 만들고 불러오기 때문

결국 `pathsWithParams`는 매개변수 쌍만 구성하는 배열로 [pid]의 값으로는 p1, p2, p3를 가짐

- dummy-backend.js 파일에는 세 가지 ID 밖에 없기 때문
- 그러므로 사전 생성되지 않은 ID의 페이지를 불러올 경우 404 에러 페이지가 뜸

## 📌 만약 fallback을 true로 설정하면 어떻게 될까?

dummy-backend.js 파일에 저장된 상품 외에도 페칭할 수 있는 데이터가 있다고 가정하면 어떨까?

getStaticPaths에서 dummy-backend.js 파일을 확인하므로 해당 파일의 세 상품에 대해서만 페이지를 생성했음

하지만 **fallback을 true로 설정함으로써 파일에서 찾을 수 없는 ID에 대해서도 페이지를 렌더링할 수 있음**

덕분에 동적 세그먼트의 모든 값에 대한 페이지를 일일이 다 사전 생성할 필요가 없음

### 이렇게 fallback을 true로 설정하고 /p4로 이동하면 '정의되지 않은 title 프로퍼티를 읽을 수 없다'는 에러 메시지가 뜸

- 낯익은 에러 메시지 → 상품 페이지를 계속 기다리는 이 폴백 상황에서 해당 메시지가 뜬 적이 있으니까!
- fallback을 **blocking이 아닌 true로 설정했을 때 NextJS는 즉시 데이터가 아직 없는 페이지를 반환하고 백그라운드에서 데이터를 불러와서 페이지를 다시 렌더링하고 화면에 표시**
- 그러므로 상품 데이터를 기다릴 땐 이 폴백 페이지를 렌더링해야 함

작업을 완료하고 페이지를 새로 고침하면 **'로딩 중' 메시지가 보이죠 그러다 에러 메시지가 뜸**

### 이번에는 정적 프로퍼티를 불러오지 못함.

ID 값이 p4인 데이터가 없는 상품 페이지를 로드하고자 함

`getStaticProps`에서는 dummy-backend.js 파일에 접근해 해당 파일에서 ID 값으로 상품을 찾는데 이 파일에는 p4에 해당하는 상품이 없음

그러므로 폴백 페이지에서 '로딩 중' 메시지가 잠깐 뜨는 동안 NextJS가 해당 페이지를 위해 요청한 데이터를 로드하려고 하지만 일치하는 상품이 없으니 실패

그 결과로 에러 메시지가 뜨는 것. 실제 데이터를 불러오는 데에 실패했으니까!

이거야말로 getStaticProps가 반환하는 객체에서 찾을 수 없는 프로퍼티에 대응하는 완벽한 예시

### 만약 상품을 불러오려고 할 때 상품의 존재 여부를 확인할 수도 있음

요청한 **ID의 상품을 찾지 못하면 notFound를 true로 설정한 객체를 반환**

이렇게 설정하면 fallback을 참으로 둘 수 있고 사전 정의되지 않은 매개 변숫값에 대한 상품을 찾기 위한 시도를 함

dummy-backend.js 파일은 해당 상품을 생산할 수 있는 보다 동적인 데이터 소스이니까

그리고 만약 페칭에 실패한다면 에러를 일으키는 데이터가 누락된 일반 페이지를 반환하는 대신에 페이지를 찾을 수 없다는 404 에러 페이지를 띄움

이대로 저장한 후 /p4로 이동하면 '로딩 중' 메시지가 뜨다가 404 에러 페이지가 뜸. 반면 /p3로 이동하면 다시 정상적인 페이지가 뜸

이렇게 **fallback을 true로 설정한 getStaticProps에서 notFound 프로퍼티를 활용할 수 있음**

_짠 시나리오와 사용 사례(use Case)에 따라 이 조합은 언제든 바뀔 수 있음_
