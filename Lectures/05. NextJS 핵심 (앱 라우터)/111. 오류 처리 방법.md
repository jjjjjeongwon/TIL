이제 이 loading.js파일은

이제 더 이상 사용하진 않지만

다음 프로젝트에서 해당 앱 폴더에 추가 가능한

유일한 특수파일은 아닙니다

Loading, page, layout 폴더 말고도

예를들면 error.js 파일도 추가할 수 있습니다

이것은 여러분의 페이지나 컴포넌트가 생성할 수도 있는

잠재적인 에러들을 다룰것입니다

예를들어 어떤 데이터를 로딩하는것을 실패한다면

그리고 그것은 우리의 데이터베이스가 오프라인이면

생길 수 있는일이며 SQL 데이터베이스에선 웬만하면 없는일이지만

원격 데이터 서버이거나

혹은 다른 것이 잘못된다고 하면

있을 수 있는 일입니다

시뮬레이션 해보기 위해 Meal.JS 파일에 있는

Lib 폴더로 가서

에러를 던져줍니다. 새로운 에러로

‘식사를 불러오는것을 실패했습니다’라거나

비슷한 것으로 하며 어떤 것이든 상관은 없습니다

그렇게 하고

이 error.js 파일을 지웁니다

곧 다시 추가하게 될것이지만

지금은 지우겠습니다

이제 페이지 새로고침을 하면 데이터 로딩이 되고

5초가 지나면

에러가 뜹니다

여기 보이는 에러 화면은

에러의 개발 버전입니다

배포 버전에서는 다르게 보일것입니다

개발 환경에서는 이 스크린을 보여주는것이

우리가 개발자로서 에러를 쉽게 찾고

고치기 편합니다

배포 환경에서는 다르게 보입니다

그러니 여러분의 어플리케이션에

에러 handling을 추가하는것이 좋겠습니다

그렇게 하려면 error.js 파일을 추가하고

그 안에 컴포넌트를 셋업하여

에러가 일어날때마다 NextJS 가 렌더링 하게 합니다

하지만 이것은 이 error파일과

같은 폴더에 있거나 중첩된 페이지나 레이아웃에서

발생하는 오류만 처리하게 됩니다

그러니 이것을 애플리케이션의

root 레벨에 심어서 그 어떤 페이지의 어떤곳에서 일어나는

에러도 잡을수 있게 할 수 있습니다

필요한만큼 세분화 하시면 됩니다

여기서 저는 한 단계만 내려가서

사이트 전체가 에러 스크린으로

바뀌지 않고

부분적으로만 바꾸게 합니다

그리고 여기에 간단히 main 요소를 불러와서

Error라는 classname을 주고

그리고 클래스 이름을 이렇게 하는 이유는

시작 프로젝트의 일부였던

이 global CSS 파일에서

제가 준비했던 클래스가 아니기 때문입니다

그러니 그것을 CSS 모듈이 아니고 전역으로 불러옵니다

해당 파일의 클래스를 다음과 같이

사용할 수 있습니다

그리고 여기엔 h1요소를 추가하여

‘오류가 발생했습니다!’ 라고 하고

오류의 몇가지 세부사항을 넣어줍니다

그리고 그것을 위해 오류에 대해 더 알려면

이 에러 페이지에서 몇가지 속성을 사용 할 수 있습니다

왜냐하면 오류나 JS파일에서 그런 컴포넌트를

설정할 때 NextJS는 해당 컴포넌트에

일부 props을 전달하기 때문입니다

제일 중요한것은 여기서 제공되는 error 속성이

이 오류에 대한 정보를 더 가지고 있을 수 있다는 것입니다

이제 실제 오류 메세지는

NextJS에 의하여 숨겨집니다

그렇게 해서 보여지지 않아야 할 정보는

엔드유저 (최종 사용자)에게 노출되지 않게 됩니다

하지만 여러분의 error이

Error 코드나 비슷한것을

가진 객체라면

그것을 여기 이 컴포넌트에 사용하여

조금 더 상세한 오류 메세지를 띄울 수 있습니다

여기서 저는 그냥 일반적인 메세지를 쓰겠습니다

‘식사 자료 로딩을 실패하였습니다’

‘나중에 다시 시도하십시오’

이제 그것을 추가하고

이 페이지를 재로딩 하면

조금 이상한것이 뜹니다

또 다른 오류가 나와서

error.js가 클라이언트 컴포넌트가 되어야 한다고 합니다

그리고 실제로 그게 맞습니다

error.js에 저장된 error 컴포넌트는

꼭 클라이언트 컴포넌트여야 합니다

NextJS는 기본적으로 클라이언트 측에서

발생하는 오류를 포함한, 해당 컴포넌트의 모든 오류를

잡을 수 있도록 보장하기 때문입니다

그러니까 페이지가 서버에서 렌더링 된 후에 말입니다

그러니 이 지시어가 여기 꼭 추가 되어야 합니다

지시어을 추가하면 여기 이게 없어진게 보입니다

지금 새로고침을 하면, 당연히 또 오류가 있지만

이제 저희가 만든 에러페이지가 뜹니다

당연히 조금 더 커스터마이징 하고싶다면 그렇게 해도 됩니다

여기서 저는 이정도로 하겠습니다 이제 이런식의 오류는

지금 이 방식대로 처리하시면 됩니다

저는 이제

Lib 폴더의 meals.js 파일로 돌아가서

이 코드를 주석 처리 하겠습니다

왜냐하면 오류를 만들고 싶은게 아니라

어떻게 처리하는지 보여드리고 싶었던 것이기 때문입니다
