# 105. 클라이언트 컴포넌트의 효율적 사용

### 📌 커뮤니티 페이지 작업

- 우선 첨부된 파일들을 추가한다.

### 📌 내비게이션에 있어 개선 사항이 있음

- **현재 어떤 페이지가 활성화 되어있는지 알 수 없음**
  - 현재 커뮤니티 페이지에 있지만 이 링크는 이곳에 있을 때 하이라이트 되어있지 않기에 이것이 하이라이트되면 더 좋을 것. 이를 수행하기 위해 다시 `main header 컴포넌트` 를 작업
  - 이 링크에 조건부적으로 클래스를 추가, 이 링크가 연결되는 페이지가 활동 중인지 아닌지에 따라서 !
  - 이를 위해 `main-header.module.css 파일` 에서 `active 스타일링` 을 위해 링크에 더해질 수 있는 `css 클래스` 를 추가
  - 이것이 active (활동 중)이라고 표시되어야 할지 아닌지를 찾는 것이 필요함
  - 현재 경로의 이름을 확인하여 어떤 경우인지를 확인할 수 있기 때문에 도메인 다음 부분을 확인하면 됨
    - 예를 들어서 이 커뮤니티 링크에서 경로는 `/community`
    - 따라서 우리는 경로가 이 경로와 같다면 여기 링크는 활동 중으로 표시되어야 함
  - Next.js가 **usePathName 훅**을 주기 때문에 꽤 명확
    - 이것은 `next/navigation` 으로부터 불러올 수 있음
    - 이 훅은 현재 활동 경로를 도메인 다음 부분에 준다
    - 그 경로가 사용 가능한 상태에서 usePathname에서 가져오는 경로가 /meals로 시작하는 경우에는 meals링크를 활성으로 설정할 수 있음
    - 따라서 이 링크는 식사 페이지나 일부 중첩된 페이지에 있더라도 활성으로 표시됨
    - 이것이 바로 startsWith를 사용하는 이유
    - 이 경우에 true라면 active css 클래스를 추가, 그렇지 않다면 undefined를 클래스로 추가하여 아무 클래스도 추가되지 않도록 함

### 📌 이렇게 하더라도 에러가 뜸

- **왜냐하면 usePathname 또한 오직 클라이언트 컴포넌트에서만 작동하기 때문**

  - `‘use client’` 지시어를 추가하면 됨
  - 여기서 기억해야 할 것!
    - 에러가 사라지고 이제 활동중인 링크가 하이라이트 되는 것을 볼 수 있음
    - 이게 작동되는 동안 일반적으로 컴포넌트 트리를 가능한 아래로 내려가서 필요한 컴포넌트만 클라이언트 컴포넌트로 변환하여 대부분의 컴포넌트가 서버 컴포넌트로 유지되고 대부분의 컴포넌트에서 서버 컴포넌트의 이점을 잃지 않도록 하려면 컴포넌트 트리를 가능한 아래로 내려가서 useClient를 추가하는 것이 좋음

- 이 header 컴포넌트가 상당히 많은 클라이언트 컴포넌트에서는 필요없는 마크업을 포함하고 있기에 저는 다른 접근을 시도!

### 📌 새로운 컴포넌트 파일 nav-link.js 라는 파일을 추가하고, 옆에 nav-link.module.css 파일을 추가

- 여기서 자바스크립트 파일에서의 목적은 NavLinkf라 불리는 컴포넌트 함수를 내보내기 하는 것
  - 이것은 단순히 NavLink를 출력
  - 따라서 main-header.js 파일에서 단순히 이 링크만을 가지고 옴. 잘라서 여기로 반환
  - href 속성을 가지고 오고 실제로 링크 사이에 출력되는 텍스트에 대한 내용은 children 속성을 사용
  - 또한 href 속성을 활용하여 active 링크인지 아닌지를 확인
  - 물론 여기에서 경로가 이용 가능하려면 전에 보여주었듯이 usePathname 훅을 사용해야만 함
  - 우리는 경로를 얻을 수 있도록 이를 클라이언트 컴포넌트로 변환(useClient를 추가)
  - 이제 main-header.js 파일로 돌아가서 NavLink 컴포넌트 파일로부터 불러오기 하고 출력
  - 이로써 메인 헤더 컴포넌트가 클라이언트 컴포넌트로 변환되지 않도록 하고 여전히 서버에서 렌더링되도록 보장하고 대신에 이 작은 부분만이 클라이언트에 렌더링 됨
