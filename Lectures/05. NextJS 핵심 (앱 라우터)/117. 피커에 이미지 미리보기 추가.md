# 117. í”¼ì»¤ì— ì´ë¯¸ì§€ ë¯¸ë¦¬ë³´ê¸° ì¶”ê°€

## ðŸ“ŒÂ ì„ íƒëœ ì‚¬ì§„ ë¯¸ë¦¬ë³´ê¸° ì¶”ê°€

- ì´ë¯¸ì§€ê°€ ì„ íƒë˜ì—ˆë‹¤ëŠ” ì´ë²¤íŠ¸ë¥¼ í•¸ë“¤ë§
- UIë¥¼ ì—…ë°ì´íŠ¸ í•  ìˆ˜ ìžˆë„ë¡ ëª‡ê°€ì§€ state(ìƒíƒœ)ë¥¼ ì €ìž¥í•´ì„œ ì‚¬ì§„ì´ ìžˆì„ë•Œ preview(ë¯¸ë¦¬ë³´ê¸°)ë¥¼ ë³´ì—¬ì£¼ê²Œ í•¨
  - ê·¸ëŸ¬ë‹ˆ ì´ ì»´í¬ë„ŒíŠ¸ì—” state (ìƒíƒœ)ê°€ í•„ìš”
  - state í›…ì„ ì“°ëŠ”ë°, ì´ê²ƒì€ ì´ ì»´í¬ë„ŒíŠ¸ë¥¼ í´ë¼ì´ì–¸íŠ¸ ì»´í¬ë„ŒíŠ¸ë¡œ ì „í™˜(`use client`)ì‹œí‚¤ëŠ”ê²ƒì´ í•„ìš”í–ˆê² ì§€ë§Œ ì—¬ê¸°ì„œ ì´ë¯¸ ê·¸ê²ƒì„ í–ˆê¸° ë•Œë¬¸ì— ë°”ê¾¸ëŠ”ê²ƒì€ í•„ìš” ì—†ìŒ
- ë‘ë²ˆì§¸ì˜ ì´ë²¤íŠ¸ í•¸ë“¤ëŸ¬ í•¨ìˆ˜ê°€ í•„ìš” - `handleImageChange`

  ```
  function handleImageChange(event) {
      const file = event.target.files[0];

      if (!file) {
        return;
      }

      const fileReader = new FileReader();

      fileReader.onload = () => {
        setPickedImage(fileReader.result);
      };
      fileReader.readAsDataURL(file);
    }
  ```

- inputì´ ìƒˆë¡œìš´ ê°’ì„ ì§€ë‹ë•Œë§ˆë‹¤ ìž‘ë™, ì¦‰ inputì˜ ì´ë²¤íŠ¸ì— ë³€í™”ê°€ ìƒê¸¸ë•Œ ë§ˆë‹¤ `onChange` ì†ì„±ì„ ì¶”ê°€í•´ì„œ `handleImageChange`ë¥¼ ê°’ìœ¼ë¡œ ì„¤ì •
- `handleImageChange`ì—ì„œëŠ” ë¦¬ì•¡íŠ¸ì— ìžˆëŠ” ì´ë²¤íŠ¸ í•¸ë“¤ëŸ¬ì—ì„œ í•­ìƒ ê·¸ë ‡ë“¯ ìžë™ìœ¼ë¡œ ì´ë²¤íŠ¸ ê°ì²´ê°€ ìƒê¹€
  - ì´ ì´ë²¤íŠ¸ ê°ì²´ë¥¼ ì‚¬ìš©í•˜ì—¬ì„œ ì„ íƒëœ ì´ë¯¸ì§€ë¥¼ ê°€ì§€ê³  ìžˆì„ ìˆ˜ ìžˆìŒ
- `event.target.files`ë¥¼ ì‚¬ìš©í•˜ì—¬ ê·¸ ì‚¬ì§„ì„ ê°€ì§€ê³  ìžˆì„ ê²ƒ

  - ê·¸ë¦¬ê³  ì²«ë²ˆì§¸ íŒŒì¼ì— ì ‘ê·¼
  - ì´ files ì†ì„±ì€ ì´ ì´ë²¤íŠ¸ì˜ ëª©ì ì´ ì´ inputì´ê¸° ë•Œë¬¸ì— ì¡´ìž¬
  - ì´ files input ì†ì„±ì€ ì‹œìŠ¤í…œ ë‚´ë¶€ì—ì„œ ê·¸ëŸ° filesì˜ ì„±ì§ˆì„ ê°€ì§€ê³  ìžˆì„ ê²ƒ
    â†’ ì„ íƒëì—ˆë˜ ëª¨ë“  íŒŒì¼ì˜ ë°°ì—´
  - ì—¬ê¸°ì„œëŠ” í•œê°€ì§€ì˜ íŒŒì¼ë§Œ ì„ íƒ ê°€ëŠ¥í•˜ë‹ˆ ì²«ë²ˆì§¸ íŒŒì¼ë§Œ ì ‘ê·¼í•  ê²ƒ
    - ìœ ì €ê°€ ì—¬ë ¤ê°œì˜ íŒŒì¼ì„ ì„ íƒí•  ìˆ˜ ìžˆê²Œ í•˜ë ¤ë©´ `multiple` ì†ì„±ì„ ì¶”ê°€í•˜ë©´ ë¨
      ![á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2024-02-21 á„‹á…©á„Œá…¥á†« 10 10 29](https://github.com/jjjjjeongwon/TIL/assets/107834862/ad490376-e360-4ae5-bda5-e3d42ed0baf9)

- ì´ì œ ì—¬ê¸°ì„œ ë¯¸ë¦¬ë³´ê¸°ë¥¼ í•˜ë ¤ë©´ Data URLì´ëž€ ê²ƒìœ¼ë¡œ ë³€í™˜ì‹œì¼œì•¼ í•¨
- ì´ëŸ° data URLì„ ìƒì„±í•˜ê¸° ìœ„í•´ì„œëŠ” ìžë°”ìŠ¤í¬ë¦½íŠ¸ì— ë‚´ìž¥ëœ í´ëž˜ìŠ¤ê°€ í•„ìš”
  - FileReader í´ëž˜ìŠ¤
  - `fileReader`ì„ `readAsDataURL`ë¡œ í•´ì„œ ê·¸ fileì„ ì´ ë©”ì†Œë“œë¡œ ì „ë‹¬
  - ì´ ë°©ì‹ì€ ì¡°ê¸ˆ íŠ¹ì´í•œ ë°©ì‹ìœ¼ë¡œ ìž‘ìš©
    - ì™œëƒí•˜ë©´ **ì•„ë¬´ê²ƒë„ ë°˜í™˜í•˜ì§€ ì•Šê¸°** ë•Œë¬¸
    - **Promiseë„ ì—†ê³  read fileë„ ì—†ìŒ ë˜í•œ ê·¸ë¦¬ê³  callbackë„ í•˜ì§€ ì•ŠìŒ**
      ![á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2024-02-21 á„‹á…©á„Œá…¥á†« 10 12 21](https://github.com/jjjjjeongwon/TIL/assets/107834862/c0c42d16-4cfa-4c91-8030-45f05d7f8514)
    - ëŒ€ì‹  `fileReader ê°ì²´`ì— ìžˆëŠ” load ì†ì„±(`onload`)ì— ê°’ì„ ì§€ì •í•˜ëŠ” ê²ƒìœ¼ë¡œ ìƒì„±ë˜ëŠ” DataURLì„ ì–»ê²Œë¨
    - í•¨ìˆ˜ë¥¼ `onload`ì˜ ê°’ìœ¼ë¡œ ì €ìž¥í•˜ê³  ì´ ë©”ì†Œë“œ, ì¦‰ ì´ data URL ë©”ì†Œë“œê°€ ì™„ë£Œë˜ë©´ ì´ í•¨ìˆ˜ëŠ” FileReaderì— ì˜í•´ ì‹¤í–‰ë¨
    - ìƒì„±ëœ URLì´ inputìœ¼ë¡œ ë˜ì§„ ì•Šê³  ëŒ€ì‹ ì— `fileReader.result`ë¥¼ ì‚¬ìš©í•´ì„œ ì ‘ê·¼í•  ìˆ˜ ìžˆìŒ ê·¸ëŸ¬ë©´ ê·¸ê²ƒì´ ìƒì„±ëœ URLì´ ë¨
- ì´ì œ ë°‘ì— controls div ì— ìƒˆë¡œìš´ divë¥¼ ì¶”ê°€í•˜ì—¬ì„œ previewë¼ëŠ” ì´ë¦„ì˜ í´ëž˜ìŠ¤ë¥¼ ë„£ê³  ì´ë¯¸ì§€ë¥¼ ë„£ìŒ
  - fill ì†ì„±ì„ ì¶”ê°€, ì™œëƒí•˜ë©´ ì„ íƒëœ ì´ë¯¸ì§€ì˜ í¬ê¸°ë¥¼ ë¯¸ë¦¬ ì•Œ ìˆ˜ ì—†ìœ¼ë‹ˆê¹Œ!

### ìµœì¢…ì½”ë“œ

```jsx
"use client";

import { useRef, useState } from "react";
import classes from "./image-picker.module.css";
import Image from "next/image";

export default function ImagePicker({ label, name }) {
  const [pickedImage, setPickedImage] = useState();
  const imageInput = useRef();

  function handlePickClick() {
    imageInput.current.click();
  }

  function handleImageChange(event) {
    const file = event.target.files[0];

    if (!file) {
      return;
    }

    const fileReader = new FileReader();

    fileReader.onload = () => {
      setPickedImage(fileReader.result);
    };
    fileReader.readAsDataURL(file);
  }

  return (
    <div className={classes.picker}>
      <label htmlFor={name}>{label}</label>
      <div className={classes.controls}>
        <div className={classes.preview}>
          {!pickedImage && <p>No image picked yet.</p>}
          {pickedImage && (
            <Image
              src={pickedImage}
              alt="The image selected by the user"
              fill
            />
          )}
        </div>
        <input
          className={classes.input}
          type="file"
          id={name}
          accept="image/png, image/jpeg"
          name={name}
          ref={imageInput}
          multiple
          onChange={handleImageChange}
        />
        <button
          className={classes.button}
          type="button"
          onClick={handlePickClick}
        >
          Pick an Image
        </button>
      </div>
    </div>
  );
}
```
